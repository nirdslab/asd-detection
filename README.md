# ASD Detection

Collection of Neural Architectures for Detection of ASD, using EEG data.

## Data
```
TRAINING: X=(311, 150, 5, 10, 5), Y=(311,), Z=(311,)
TESTING: X=(180, 150, 5, 10, 5), Y=(180,), Z=(180,)
```

## Models Used
* **CONV** - Convolution Model
* **LSTM** - LSTM Model
* **CAPS** - CapsNet Model

## Results

```
Model: "asd_conv"
3/3 - 3s - loss: 1.2569 - crossentropy_loss: 0.5766 - mae: 5.7903 - acc: 0.7778
________________________________________________________________________________
Model: "asd_lstm"
3/3 - 0s - loss: 1.0333 - crossentropy_loss: 0.6479 - mae: 7.1305 - acc: 0.6444
________________________________________________________________________________
Model: "asd_caps"
3/3 - 3s - loss: 0.4085 - margin_loss: 0.0961 - mae: 5.9307 - acc: 0.8611
________________________________________________________________________________
```

| Model    | Loss     | MAE      | Accuracy |
|----------|----------|----------|----------|
| **CONV** | 1.2569   | 5.7903   | 0.7778   |
| **LSTM** | 1.0333   | 7.1305   | 0.6444   |
| **CAPS** | 0.4085   | 5.9307   | 0.8611   |

## Electrode Placement
![Full-Scale](figures/eeg-placement.png)
![Minimal](figures/eeg-placement-2.png)

## Power Spectrum Visualizations

![Participant 007 (NT)](figures/007.png)
![Participant 018 (ASD)](figures/018.png)

## Model Architecture

### CONV Model
```
Model: "asd_conv"
______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_1 (InputLayer)                             [(None, 150, 5, 10, 5)]          0                                                                   
______________________________________________________________________________________________________________________________________________________
reshape (Reshape)                                (None, 150, 50, 5)               0                 input_1[0][0]                                     
______________________________________________________________________________________________________________________________________________________
conv_1 (Conv2D)                                  (None, 146, 50, 8)               208               reshape[0][0]                                     
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_1 (BatchNormalization)                 (None, 146, 50, 8)               32                conv_1[0][0]                                      
______________________________________________________________________________________________________________________________________________________
db_relu_1_1 (ReLU)                               (None, 146, 50, 8)               0                 db_bnrm_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_1 (Conv2D)                             (None, 146, 50, 8)               328               db_relu_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_1 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_2 (BatchNormalization)                 (None, 146, 50, 8)               32                db_drop_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_relu_1_2 (ReLU)                               (None, 146, 50, 8)               0                 db_bnrm_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_2 (Conv2D)                             (None, 146, 50, 8)               328               db_relu_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_2 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_2 (Concatenate)                              (None, 146, 50, 16)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_3 (BatchNormalization)                 (None, 146, 50, 16)              64                c_1_2[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_1_3 (ReLU)                               (None, 146, 50, 16)              0                 db_bnrm_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_3 (Conv2D)                             (None, 146, 50, 8)               648               db_relu_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_3 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_3 (Concatenate)                              (None, 146, 50, 24)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
                                                                                                    db_drop_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_4 (BatchNormalization)                 (None, 146, 50, 24)              96                c_1_3[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_1_4 (ReLU)                               (None, 146, 50, 24)              0                 db_bnrm_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_4 (Conv2D)                             (None, 146, 50, 8)               968               db_relu_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_4 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_4 (Concatenate)                              (None, 146, 50, 32)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
                                                                                                    db_drop_1_3[0][0]                                 
                                                                                                    db_drop_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
tb_bnrm_1 (BatchNormalization)                   (None, 146, 50, 32)              128               c_1_4[0][0]                                       
______________________________________________________________________________________________________________________________________________________
tb_relu_1 (ReLU)                                 (None, 146, 50, 32)              0                 tb_bnrm_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_conv_1 (Conv2D)                               (None, 146, 50, 32)              1056              tb_relu_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_dropout_1 (Dropout)                           (None, 146, 50, 32)              0                 tb_conv_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_pool_1 (AveragePooling2D)                     (None, 73, 50, 32)               0                 tb_dropout_1[0][0]                                
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_1 (BatchNormalization)                 (None, 73, 50, 32)               128               tb_pool_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
db_relu_2_1 (ReLU)                               (None, 73, 50, 32)               0                 db_bnrm_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_1 (Conv2D)                             (None, 73, 50, 8)                1288              db_relu_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_1 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_2 (BatchNormalization)                 (None, 73, 50, 8)                32                db_drop_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_relu_2_2 (ReLU)                               (None, 73, 50, 8)                0                 db_bnrm_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_2 (Conv2D)                             (None, 73, 50, 8)                328               db_relu_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_2 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_2 (Concatenate)                              (None, 73, 50, 16)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_3 (BatchNormalization)                 (None, 73, 50, 16)               64                c_2_2[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_3 (ReLU)                               (None, 73, 50, 16)               0                 db_bnrm_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_3 (Conv2D)                             (None, 73, 50, 8)                648               db_relu_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_3 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_3 (Concatenate)                              (None, 73, 50, 24)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_4 (BatchNormalization)                 (None, 73, 50, 24)               96                c_2_3[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_4 (ReLU)                               (None, 73, 50, 24)               0                 db_bnrm_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_4 (Conv2D)                             (None, 73, 50, 8)                968               db_relu_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_4 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_4 (Concatenate)                              (None, 73, 50, 32)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_5 (BatchNormalization)                 (None, 73, 50, 32)               128               c_2_4[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_5 (ReLU)                               (None, 73, 50, 32)               0                 db_bnrm_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_5 (Conv2D)                             (None, 73, 50, 8)                1288              db_relu_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_5 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_5 (Concatenate)                              (None, 73, 50, 40)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_6 (BatchNormalization)                 (None, 73, 50, 40)               160               c_2_5[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_6 (ReLU)                               (None, 73, 50, 40)               0                 db_bnrm_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_6 (Conv2D)                             (None, 73, 50, 8)                1608              db_relu_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_6 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_6 (Concatenate)                              (None, 73, 50, 48)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_7 (BatchNormalization)                 (None, 73, 50, 48)               192               c_2_6[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_7 (ReLU)                               (None, 73, 50, 48)               0                 db_bnrm_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_7 (Conv2D)                             (None, 73, 50, 8)                1928              db_relu_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_7 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_7 (Concatenate)                              (None, 73, 50, 56)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
                                                                                                    db_drop_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_8 (BatchNormalization)                 (None, 73, 50, 56)               224               c_2_7[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_8 (ReLU)                               (None, 73, 50, 56)               0                 db_bnrm_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_8 (Conv2D)                             (None, 73, 50, 8)                2248              db_relu_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_8 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_8 (Concatenate)                              (None, 73, 50, 64)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
                                                                                                    db_drop_2_7[0][0]                                 
                                                                                                    db_drop_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
tb_bnrm_2 (BatchNormalization)                   (None, 73, 50, 64)               256               c_2_8[0][0]                                       
______________________________________________________________________________________________________________________________________________________
tb_relu_2 (ReLU)                                 (None, 73, 50, 64)               0                 tb_bnrm_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_conv_2 (Conv2D)                               (None, 73, 50, 64)               4160              tb_relu_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_dropout_2 (Dropout)                           (None, 73, 50, 64)               0                 tb_conv_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_pool_2 (AveragePooling2D)                     (None, 36, 50, 64)               0                 tb_dropout_2[0][0]                                
______________________________________________________________________________________________________________________________________________________
flatten_ol (Flatten)                             (None, 115200)                   0                 tb_pool_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
l (Dense)                                        (None, 2)                        230402            flatten_ol[0][0]                                  
______________________________________________________________________________________________________________________________________________________
s (Dense)                                        (None, 1)                        115201            flatten_ol[0][0]                                  
======================================================================================================================================================
Total params: 365,235
Trainable params: 364,419
Non-trainable params: 816
______________________________________________________________________________________________________________________________________________________
```

### LSTM Model
```
Model: "asd_lstm"
______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_1 (InputLayer)                             [(None, 150, 5, 10, 5)]          0                                                                   
______________________________________________________________________________________________________________________________________________________
reshape (Reshape)                                (None, 150, 250)                 0                 input_1[0][0]                                     
______________________________________________________________________________________________________________________________________________________
h_lstm1 (LSTM)                                   (None, 150, 32)                  36224             reshape[0][0]                                     
______________________________________________________________________________________________________________________________________________________
h_lstm2 (LSTM)                                   (None, 150, 32)                  8320              h_lstm1[0][0]                                     
______________________________________________________________________________________________________________________________________________________
h_concat_1 (Concatenate)                         (None, 150, 64)                  0                 h_lstm1[0][0]                                     
                                                                                                    h_lstm2[0][0]                                     
______________________________________________________________________________________________________________________________________________________
h_lstm3 (LSTM)                                   (None, 150, 32)                  12416             h_concat_1[0][0]                                  
______________________________________________________________________________________________________________________________________________________
h_concat_2 (Concatenate)                         (None, 150, 96)                  0                 h_lstm1[0][0]                                     
                                                                                                    h_lstm2[0][0]                                     
                                                                                                    h_lstm3[0][0]                                     
______________________________________________________________________________________________________________________________________________________
h_lstm4 (LSTM)                                   (None, 150, 32)                  16512             h_concat_2[0][0]                                  
______________________________________________________________________________________________________________________________________________________
h_concat_3 (Concatenate)                         (None, 150, 128)                 0                 h_lstm1[0][0]                                     
                                                                                                    h_lstm2[0][0]                                     
                                                                                                    h_lstm3[0][0]                                     
                                                                                                    h_lstm4[0][0]                                     
______________________________________________________________________________________________________________________________________________________
f_lstm (LSTM)                                    (None, 32)                       20608             h_concat_3[0][0]                                  
______________________________________________________________________________________________________________________________________________________
dense (Dense)                                    (None, 32)                       1056              f_lstm[0][0]                                      
______________________________________________________________________________________________________________________________________________________
l (Dense)                                        (None, 2)                        66                dense[0][0]                                       
______________________________________________________________________________________________________________________________________________________
s (Dense)                                        (None, 1)                        33                dense[0][0]                                       
======================================================================================================================================================
Total params: 95,235
Trainable params: 95,235
Non-trainable params: 0
______________________________________________________________________________________________________________________________________________________
```

### CAPS Model
```
Model: "asd_caps"
______________________________________________________________________________________________________________________________________________________
Layer (type)                                     Output Shape                     Param #           Connected to                                      
======================================================================================================================================================
input_1 (InputLayer)                             [(None, 150, 5, 10, 5)]          0                                                                   
______________________________________________________________________________________________________________________________________________________
eeg (Reshape)                                    (None, 150, 50, 5)               0                 input_1[0][0]                                     
______________________________________________________________________________________________________________________________________________________
conv_1 (Conv2D)                                  (None, 146, 50, 8)               208               eeg[0][0]                                         
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_1 (BatchNormalization)                 (None, 146, 50, 8)               32                conv_1[0][0]                                      
______________________________________________________________________________________________________________________________________________________
db_relu_1_1 (ReLU)                               (None, 146, 50, 8)               0                 db_bnrm_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_1 (Conv2D)                             (None, 146, 50, 8)               328               db_relu_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_1 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_2 (BatchNormalization)                 (None, 146, 50, 8)               32                db_drop_1_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_relu_1_2 (ReLU)                               (None, 146, 50, 8)               0                 db_bnrm_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_2 (Conv2D)                             (None, 146, 50, 8)               328               db_relu_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_2 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_2 (Concatenate)                              (None, 146, 50, 16)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_3 (BatchNormalization)                 (None, 146, 50, 16)              64                c_1_2[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_1_3 (ReLU)                               (None, 146, 50, 16)              0                 db_bnrm_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_3 (Conv2D)                             (None, 146, 50, 8)               648               db_relu_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_3 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_3 (Concatenate)                              (None, 146, 50, 24)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
                                                                                                    db_drop_1_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_1_4 (BatchNormalization)                 (None, 146, 50, 24)              96                c_1_3[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_1_4 (ReLU)                               (None, 146, 50, 24)              0                 db_bnrm_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_1_4 (Conv2D)                             (None, 146, 50, 8)               968               db_relu_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_1_4 (Dropout)                            (None, 146, 50, 8)               0                 db_conv_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_1_4 (Concatenate)                              (None, 146, 50, 32)              0                 db_drop_1_1[0][0]                                 
                                                                                                    db_drop_1_2[0][0]                                 
                                                                                                    db_drop_1_3[0][0]                                 
                                                                                                    db_drop_1_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
tb_bnrm_1 (BatchNormalization)                   (None, 146, 50, 32)              128               c_1_4[0][0]                                       
______________________________________________________________________________________________________________________________________________________
tb_relu_1 (ReLU)                                 (None, 146, 50, 32)              0                 tb_bnrm_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_conv_1 (Conv2D)                               (None, 146, 50, 32)              1056              tb_relu_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_dropout_1 (Dropout)                           (None, 146, 50, 32)              0                 tb_conv_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_pool_1 (AveragePooling2D)                     (None, 73, 50, 32)               0                 tb_dropout_1[0][0]                                
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_1 (BatchNormalization)                 (None, 73, 50, 32)               128               tb_pool_1[0][0]                                   
______________________________________________________________________________________________________________________________________________________
db_relu_2_1 (ReLU)                               (None, 73, 50, 32)               0                 db_bnrm_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_1 (Conv2D)                             (None, 73, 50, 8)                1288              db_relu_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_1 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_2 (BatchNormalization)                 (None, 73, 50, 8)                32                db_drop_2_1[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_relu_2_2 (ReLU)                               (None, 73, 50, 8)                0                 db_bnrm_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_2 (Conv2D)                             (None, 73, 50, 8)                328               db_relu_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_2 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_2 (Concatenate)                              (None, 73, 50, 16)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_3 (BatchNormalization)                 (None, 73, 50, 16)               64                c_2_2[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_3 (ReLU)                               (None, 73, 50, 16)               0                 db_bnrm_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_3 (Conv2D)                             (None, 73, 50, 8)                648               db_relu_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_3 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_3 (Concatenate)                              (None, 73, 50, 24)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_4 (BatchNormalization)                 (None, 73, 50, 24)               96                c_2_3[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_4 (ReLU)                               (None, 73, 50, 24)               0                 db_bnrm_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_4 (Conv2D)                             (None, 73, 50, 8)                968               db_relu_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_4 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_4 (Concatenate)                              (None, 73, 50, 32)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_5 (BatchNormalization)                 (None, 73, 50, 32)               128               c_2_4[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_5 (ReLU)                               (None, 73, 50, 32)               0                 db_bnrm_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_5 (Conv2D)                             (None, 73, 50, 8)                1288              db_relu_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_5 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_5 (Concatenate)                              (None, 73, 50, 40)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_6 (BatchNormalization)                 (None, 73, 50, 40)               160               c_2_5[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_6 (ReLU)                               (None, 73, 50, 40)               0                 db_bnrm_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_6 (Conv2D)                             (None, 73, 50, 8)                1608              db_relu_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_6 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_6 (Concatenate)                              (None, 73, 50, 48)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_7 (BatchNormalization)                 (None, 73, 50, 48)               192               c_2_6[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_7 (ReLU)                               (None, 73, 50, 48)               0                 db_bnrm_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_7 (Conv2D)                             (None, 73, 50, 8)                1928              db_relu_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_7 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_7 (Concatenate)                              (None, 73, 50, 56)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
                                                                                                    db_drop_2_7[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_bnrm_2_8 (BatchNormalization)                 (None, 73, 50, 56)               224               c_2_7[0][0]                                       
______________________________________________________________________________________________________________________________________________________
db_relu_2_8 (ReLU)                               (None, 73, 50, 56)               0                 db_bnrm_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_conv_2_8 (Conv2D)                             (None, 73, 50, 8)                2248              db_relu_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
db_drop_2_8 (Dropout)                            (None, 73, 50, 8)                0                 db_conv_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
c_2_8 (Concatenate)                              (None, 73, 50, 64)               0                 db_drop_2_1[0][0]                                 
                                                                                                    db_drop_2_2[0][0]                                 
                                                                                                    db_drop_2_3[0][0]                                 
                                                                                                    db_drop_2_4[0][0]                                 
                                                                                                    db_drop_2_5[0][0]                                 
                                                                                                    db_drop_2_6[0][0]                                 
                                                                                                    db_drop_2_7[0][0]                                 
                                                                                                    db_drop_2_8[0][0]                                 
______________________________________________________________________________________________________________________________________________________
tb_bnrm_2 (BatchNormalization)                   (None, 73, 50, 64)               256               c_2_8[0][0]                                       
______________________________________________________________________________________________________________________________________________________
tb_relu_2 (ReLU)                                 (None, 73, 50, 64)               0                 tb_bnrm_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_conv_2 (Conv2D)                               (None, 73, 50, 64)               4160              tb_relu_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_dropout_2 (Dropout)                           (None, 73, 50, 64)               0                 tb_conv_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
tb_pool_2 (AveragePooling2D)                     (None, 36, 50, 64)               0                 tb_dropout_2[0][0]                                
______________________________________________________________________________________________________________________________________________________
conv_caps (ConvCaps2D)                           (None, 16, 50, 8, 4)             10272             tb_pool_2[0][0]                                   
______________________________________________________________________________________________________________________________________________________
lambda (Lambda)                                  (None, 16, 50, 8, 4)             0                 conv_caps[0][0]                                   
______________________________________________________________________________________________________________________________________________________
dense_caps (DenseCaps)                           (None, 2, 8)                     409600            lambda[0][0]                                      
______________________________________________________________________________________________________________________________________________________
lambda_1 (Lambda)                                (None, 2, 8)                     0                 dense_caps[0][0]                                  
______________________________________________________________________________________________________________________________________________________
lambda_2 (Lambda)                                (None, 8)                        0                 lambda_1[0][0]                                    
______________________________________________________________________________________________________________________________________________________
l (Lambda)                                       (None, 2)                        0                 lambda_1[0][0]                                    
______________________________________________________________________________________________________________________________________________________
s (Dense)                                        (None, 1)                        9                 lambda_2[0][0]                                    
======================================================================================================================================================
Total params: 439,513
Trainable params: 438,697
Non-trainable params: 816
______________________________________________________________________________________________________________________________________________________
```

